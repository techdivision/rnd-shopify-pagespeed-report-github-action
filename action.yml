name: 'Pagespeed Report for Shopify'
description: 'Run Pagespeed on a Shopify store and send the report to a Google Cloud Function.'
inputs:
  project:
    description: 'The JIRA project ID.'
    required: true
    default: 'CHANGEME'
  store:
    description: 'The Shopify store URL.'
    required: true
    default: 'changeme.myshopify.com'
  access_token:
    description: 'The Shopify access token.'
    required: true
  # commit hash to identify the change responsible for this test
  commit_hash:
    description: 'The git commit hash.'
    required: true
  # branch to group the results
  branch:
    description: 'The git branch.'
    required: true
  sa_key:
    description: 'The Google Cloud service account key.'
    required: true
runs:
  using: 'composite'
  steps:
    - name: Run PageSpeed script
      shell: bash
      run: ${{ github.action_path }}/run.sh
      env:
        BRANCH: ${{ inputs.branch }}
        COMMIT_HASH: ${{ inputs.commit_hash }}
        PROJECT: ${{ inputs.project }}
        STORE: ${{ inputs.store }}
        ACCESS_TOKEN: ${{ inputs.access_token }}
        SA_KEY: ${{ inputs.sa_key }}
